[
    {
        "test_name": "opkg_update",
        "commands": [
            "opkg update && export RESULT='Update completed'",
            "wait_and_reset_serial_buffers 0",
            "echo $RESULT && unset RESULT"
        ],
        "expected_response": "Update completed",
        "timeout": 120,
        "if_failed": "Check your Internet connection"
    },
    {
        "test_name": "opkg_install_dependencies_kmod_pwm",
        "commands": [
            "[[ -z $(opkg list-installed | grep -q 'kmod-pwm-mediatek-ramips') ]] && export RESULT='The package has been installed' || export RESULT='Not found'",
            "[[ $RESULT=='Not found' ]] && [[ -z $(opkg install kmod-pwm-mediatek-ramips | grep -q 'Configuring kmod-pwm-mediatek-ramips') ]] && RESULT='The package has been installed'",
            "wait_and_reset_serial_buffers 0",
            "echo $RESULT && unset RESULT"
        ],
        "expected_response": "The package has been installed",
        "timeout": 30,
        "if_failed": "https://documentation.onioniot.com/hardware-interfaces/pwm"
    },
    {
        "test_name": "opkg_install_dependencies_omega2_script",
        "commands": [
            "[[ -z $(opkg list-installed | grep -q 'omega2-script') ]] && export RESULT='The package has been installed' || export RESULT='Not found'",
            "[[ $RESULT2=='Not found' ]] && [[ -z $(opkg install omega2-script | grep -q 'Configuring omega2-script') ]] && RESULT='The package has been installed'",
            "wait_and_reset_serial_buffers 0",
            "echo $RESULT && unset RESULT"
        ],
        "expected_response": "The package has been installed",
        "timeout": 30,
        "if_failed": "https://documentation.onioniot.com/hardware-interfaces/pwm"
    },
    {
        "test_name": "adjust_pin_multiplexing",
        "commands": [
            "omega2-ctrl gpiomux set pwm0 pwm",
            "wait_and_reset_serial_buffers 0",
            "echo $?"
        ],
        "expected_response": "0",
        "timeout": 5,
        "if_failed": ""
    },
    {
        "test_name": "generate_pwm_signal",
        "commands": [
            "onion pwm 0 50 123456",
            "wait_and_reset_serial_buffers 0",
            "echo $?"
        ],
        "expected_response": "0",
        "timeout": 5,
        "if_failed": ""
    },
    {
        "test_name": "stop_pwm_signal",
        "commands": [
            "onion pwm 0 disable",
            "wait_and_reset_serial_buffers 0",
            "echo $?"
        ],
        "expected_response": "0",
        "timeout": 5,
        "if_failed": ""
    }
]
